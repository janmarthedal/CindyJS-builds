(function(){
'use strict';var q;function r(a){this.f=a}r.prototype.toString=function(){return this.f};
function aa(a,b,c){this.f=a.createProgram();this.i=ba(this,a,a.VERTEX_SHADER,b);this.g=ba(this,a,a.FRAGMENT_SHADER,c);b=this.f;a.linkProgram(b);if(!a.getProgramParameter(b,a.LINK_STATUS))throw new r("Error linking shader:\n"+a.getProgramInfoLog(b));a.validateProgram(b);if(!a.getProgramParameter(b,a.VALIDATE_STATUS))throw new r("Error validating shader:\n"+a.getProgramInfoLog(b));var d=this.f,e,g,f,l={},m,k,n,h;c=a.getProgramParameter(d,a.ACTIVE_UNIFORMS);for(b=0;b<c;++b)if(e=a.getActiveUniform(d,
b))if(g=e.name.replace(/\]/g,"")){for(m=l;f=/[.\[]/.exec(g);)k=g.substr(0,f.index),m.hasOwnProperty(k)?m=m[k]:"."===f[0]?m=m[k]={}:m=m[k]=[],g=g.substr(f.index+1);if(1<e.size){f=e.size;h=Array(f);for(k=0;k<f;++k)n=e.name+"["+k+"]",n=ca(this,a,n,e),h[k]=n;m[g]=h}else n=ca(this,a,e.name,e),m[g]=n}this.h=l}
function ba(a,b,c,d){c=b.createShader(c);b.shaderSource(c,d);b.compileShader(c);if(!b.getShaderParameter(c,b.COMPILE_STATUS))throw console.warn(d.split("\n")),new r("Error compiling shader:\n"+b.getShaderInfoLog(c));b.attachShader(a.f,c);return c}function da(a,b){b.detachShader(a.f,a.i);b.deleteShader(a.i);b.detachShader(a.f,a.g);b.deleteShader(a.g);b.deleteProgram(a.f)}
function ca(a,b,c,d){a=b.getUniformLocation(a.f,c);switch(d.type){case b.FLOAT:return b.uniform1fv.bind(b,a);case b.FLOAT_VEC2:return b.uniform2fv.bind(b,a);case b.FLOAT_VEC3:return b.uniform3fv.bind(b,a);case b.FLOAT_VEC4:return b.uniform4fv.bind(b,a);case b.BOOL:case b.INT:case b.SAMPLER_2D:case b.SAMPLER_CUBE:return b.uniform1iv.bind(b,a);case b.BOOL_VEC2:case b.INT_VEC2:return b.uniform2iv.bind(b,a);case b.BOOL_VEC3:case b.INT_VEC3:return b.uniform3iv.bind(b,a);case b.BOOL_VEC4:case b.INT_VEC4:return b.uniform4iv.bind(b,
a);case b.FLOAT_MAT2:return b.uniformMatrix2fv.bind(b,a,!1);case b.FLOAT_MAT3:return b.uniformMatrix3fv.bind(b,a,!1);case b.FLOAT_MAT4:return b.uniformMatrix4fv.bind(b,a,!1);default:throw new r("Unknown data type for uniform "+c);}};function ea(a){var b=a[0],c=a[1];a=a[2];var d=1/Math.sqrt(b*b+c*c+a*a);return[d*b,d*c,d*a]}function t(a){var b=1/a[3];return[b*a[0],b*a[1],b*a[2]]}function fa(a,b){return[a*b[0],a*b[1],a*b[2]]}function u(a,b){return[a[0]-b[0],a[1]-b[1],a[2]-b[2]]}function ga(a,b){return[a[0]+b[0],a[1]+b[1],a[2]+b[2]]}function ha(a,b){return[a[0]+b[0],a[1]+b[1],a[2]+b[2],a[3]+b[3]]}function w(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}
function x(a,b){return[a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*b[15],a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12],a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],a[8]*b[3]+a[9]*b[7]+
a[10]*b[11]+a[11]*b[15],a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15]]}function ia(a,b,c){a=t(a);return ea(w(u(t(b),a),u(t(c),a)))};function ja(a,b){this.width=a;this.height=b;this.ea=Math.PI/360*45;this.X=.1;this.W=100;ka(this);la(this,[0,0,5],[0,0,0],[0,1,0])}function ka(a){var b=1/Math.tan(a.ea),c=a.X-a.W;a.s=[b*a.height/a.width,0,0,0,0,b,0,0,0,0,(a.W+a.X)/c,-1,0,0,2*a.W*a.X/c,0]}
function la(a,b,c,d){b=u(b,c);var e=b[0],g=b[1],f=b[2];a.h=Math.sqrt(e*e+g*g+f*f);b=ea(b);d=ea(w(d,b));e=w(b,d);d=[d[0],e[0],b[0],d[1],e[1],b[1],d[2],e[2],b[2]];d=[d[4]*d[8]-d[5]*d[7],d[2]*d[7]-d[1]*d[8],d[1]*d[5]-d[2]*d[4],d[5]*d[6]-d[3]*d[8],d[0]*d[8]-d[2]*d[6],d[2]*d[3]-d[0]*d[5],d[3]*d[7]-d[4]*d[6],d[1]*d[6]-d[0]*d[7],d[0]*d[4]-d[1]*d[3]];c=[d[0]*c[0]+d[1]*c[1]+d[2]*c[2],d[3]*c[0]+d[4]*c[1]+d[5]*c[2],d[6]*c[0]+d[7]*c[1]+d[8]*c[2]];a.f=[d[0],d[1],d[2],-c[0],d[3],d[4],d[5],-c[1],d[6],d[7],d[8],
-c[2],0,0,0,1];a.i=[1,0,0,0,0,1,0,0,0,0,1,-a.h,0,0,0,1];a.g=x(a.i,a.f)};function ma(a){return{color:a,alpha:1,l:60,size:.05}}function y(a){return{color:a.color,alpha:a.alpha,l:a.l,size:a.size}};function B(a,b,c,d){function e(a){g.removeEventListener("webglcontextcreationerror",e,!1);a.statusMessage&&(f=a.statusMessage)}var g=document.getElementById(a);if(!g)throw new r("No canvas element with id "+a);var f="Unknown";g.addEventListener("webglcontextcreationerror",e,!1);(a=g.getContext("webgl",b))||(a=g.getContext("experimental-webgl",b));if(!a)throw new r("Could not obtain a WebGL context.\nReason: "+f);g.removeEventListener("webglcontextcreationerror",e,!1);a.depthFunc(a.LEQUAL);a.blendFunc(a.SRC_ALPHA,
a.ONE_MINUS_SRC_ALPHA);this.R=g;this.width=g.width;this.height=g.height;this.f=a;/[?&]frag_depth=0/.test(window.location.search)?this.B=null:(this.B=a.getExtension("EXT_frag_depth"))||console.log("EXT_frag_depth extension not supported, will render with reduced quality.");this.g=1;c&&c.ha&&(this.g=c.ha|0,1>this.g&&(this.g=1));if(1!==this.g){b=this.width*this.height*this.g;for(c=64;c*c<b;)c*=2;this.s=this.i=c;this.G=a.createTexture();a.bindTexture(a.TEXTURE_2D,this.G);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_LINEAR);a.hint(a.GENERATE_MIPMAP_HINT,a.NICEST);a.texImage2D(a.TEXTURE_2D,0,a.RGB,this.s,this.i,0,a.RGB,a.UNSIGNED_BYTE,null);a.generateMipmap(a.TEXTURE_2D);a.bindTexture(a.TEXTURE_2D,null);this.N=a.createRenderbuffer();a.bindRenderbuffer(a.RENDERBUFFER,this.N);a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,this.s,this.i);a.bindRenderbuffer(a.RENDERBUFFER,null);this.O=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,
this.O);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.G,0);a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,this.N);b=a.checkFramebufferStatus(a.FRAMEBUFFER);if(b!==a.FRAMEBUFFER_COMPLETE)throw new r("Failed to create supersampling framebuffer. glCheckFramebufferStatus returned "+b);a.bindFramebuffer(a.FRAMEBUFFER,null);this.P=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.P);a.bufferData(a.ARRAY_BUFFER,new Float32Array([1,1,1,1,-1,1,0,1,1,
-1,1,0,-1,-1,0,0]),a.STATIC_DRAW);this.I=new aa(a,"precision mediump float;\n\nattribute vec4 aPos;\nvarying vec2 vPos;\n\nvoid main(){\nvPos=aPos.zw;\ngl_Position=vec4(aPos.xy,0,1);\n}\n","precision mediump float;\n\nuniform sampler2D uTexture;\nvarying vec2 vPos;\n\nvoid main(){\ngl_FragColor=texture2D(uTexture,vPos);\n}\n");this.H=a.getAttribLocation(this.I.f,"aPos")}else this.s=this.width,this.i=this.height;this.C=new ta;this.M="uniform vec3 uAmbient;\nuniform mat4 uModelViewMatrix;\n\nvarying vec4 vColor;\nvarying float vShininess;\n\nvec4 gColor;\nvec3 gPos;\nvec3 gEye;\nvec3 gNormal;\nvec3 gAccumDiffuse;\nvec3 gAccumSpecular;\n\nvoid commonLight(in vec4 lightPos,out vec3 lightDir,\nout float diffuseFactor,out float specularFactor){\nvec3 halfVector;\nfloat specularDot;\n\nlightDir=normalize(lightPos.xyz-lightPos.w*gPos);\nhalfVector=normalize(lightDir+gEye);\ndiffuseFactor=max(0.0,dot(gNormal,lightDir));\nspecularDot=max(0.0,dot(gNormal,halfVector));\n\n\nif(diffuseFactor==0.0)\nspecularFactor=0.0;\nelse\nspecularFactor=pow(specularDot,vShininess);\n}\n\nvec4 flipY(in vec4 v){\nreturn vec4(v.x, -v.y,v.z,v.w);\n}\n\nvoid pointLight(in vec4 lightPos,in vec3 diffuse,in vec3 specular){\nvec3 lightDir;\nfloat diffuseFactor;\nfloat specularFactor;\n\ncommonLight(lightPos,lightDir,diffuseFactor,specularFactor);\n\n\ngAccumDiffuse +=diffuse*diffuseFactor;\ngAccumSpecular+=specular*specularFactor;\n}\n\nvoid cameraPointLight(in vec4 lightPos,in vec3 diffuse,in vec3 specular){\npointLight(flipY(lightPos),diffuse,specular);\n}\n\nvoid worldPointLight(in vec4 lightPos,in vec3 diffuse,in vec3 specular){\npointLight(-uModelViewMatrix*lightPos,diffuse,specular);\n}\n\nvoid spotLight(\nin vec4 lightPos,in vec4 spotPos,in float spotCosCutoff,\nin float spotExponent,in vec3 diffuse,in vec3 specular)\n{\nvec3 lightDir;\nfloat diffuseFactor;\nfloat specularFactor;\nvec3 spotDir;\nfloat spotCosAngle;\nfloat spotAttenuation;\n\ncommonLight(lightPos,lightDir,diffuseFactor,specularFactor);\n\nspotDir=lightPos.w*spotPos.xyz-spotPos.w*lightPos.xyz;\nspotCosAngle=dot(-lightDir,normalize(spotDir));\nspotAttenuation=\nstep(spotCosCutoff,spotCosAngle) *pow(spotCosAngle,spotExponent);\n\n\ngAccumDiffuse +=spotAttenuation*diffuse*diffuseFactor;\ngAccumSpecular+=spotAttenuation*specular*specularFactor;\n}\n\nvoid cameraSpotLight(\nin vec4 lightPos,in vec4 spotPos,in float spotCosCutoff,\nin float spotExponent,in vec3 diffuse,in vec3 specular)\n{\nspotLight(\nflipY(lightPos),flipY(spotPos),\nspotCosCutoff,spotExponent,diffuse,specular);\n}\n\nvoid worldSpotLight(\nin vec4 lightPos,in vec4 spotPos,in float spotCosCutoff,\nin float spotExponent,in vec3 diffuse,in vec3 specular)\n{\nspotLight(\n-uModelViewMatrix*lightPos, -uModelViewMatrix*spotPos,\nspotCosCutoff,spotExponent,diffuse,specular);\n}\n"+
ua(this.C)+"\n\n\n\n\n\nvoid shade(in vec3 position,in vec3 normal){\n\ngAccumDiffuse=vec3(0.0);\ngAccumSpecular=vec3(0.0);\n\n\ngPos=position;\ngEye= -normalize(position);\ngNormal=sign(dot(gEye,normal))*normal;\n\n\nlightScene();\n\n\n\nvec3 color= (uAmbient+gAccumDiffuse) *gColor.xyz\n+gAccumSpecular;\n\ncolor=clamp(color,0.0,1.0);\ngl_FragColor=vec4(color.xyz,gColor.w);\n}\n";this.A=new ja(this.width,this.height);this.K=new C(this);this.J=new D(this);this.o=new va(this);this.w=y(G.U);this.u=y(G.T);
this.m=y(G.V);this.da=[];this.backgroundColor=[1,1,1,1];this.F=null;d||(d=function(a,b,c,d){a.addEventListener(b,c,!!d)});wa(this,d)}var G={U:y(ma([1,0,0])),T:y(ma([0,0,1])),V:y(ma([0,1,0]))};
function wa(a,b){var c=a.R,d=Number.NaN,e=Number.NaN,g=!1,f=a.A,l=a.S.bind(a);b(c,"mousedown",function(a){a.button||(g=!0);if(void 0===a.buttons?g:a.buttons&1)d=a.screenX,e=a.screenY});b(c,"mousemove",function(a){if(void 0===a.buttons?g:a.buttons&1){if(!isNaN(d)){var b=a.screenX-d,c=a.screenY-e;if(a.shiftKey){var h=-.01*b,p=-.01*c,c=Math.cos(h),b=Math.cos(p),h=Math.sin(h),p=Math.sin(p),z=[1,0,0,0,0,1,0,0,0,0,1,f.h,0,0,0,1];f.g=x(x([c,0,h,0,0,1,0,0,-h,0,c,0,0,0,0,1],[1,0,0,0,0,b,-p,0,0,p,b,0,0,0,0,
1]),f.g);f.f=x(z,f.g)}else a.altKey||a.ctrlKey||a.metaKey?(h=.002*f.h,f.f=x([1,0,0,h*b,0,1,0,-h*c,0,0,1,0,0,0,0,1],f.f)):(h=.01*b,p=.01*c,c=Math.cos(h),b=Math.cos(p),h=Math.sin(h),p=Math.sin(p),f.f=x(x([c,0,h,0,0,1,0,0,-h,0,c,0,0,0,0,1],[1,0,0,0,0,b,-p,0,0,p,b,0,0,0,0,1]),f.f)),f.g=x(f.i,f.f);l()}d=a.screenX;e=a.screenY}});b(c,"mouseup",function(a){a.button||(g=!1)});b(c,"mouseleave",function(){g=!1;d=e=Number.NaN});b(c,"wheel",function(a){var b=a.deltaY;if(b){if(a.shiftKey){var c=-.01*b,b=Math.cos(c),
c=Math.sin(c);f.f=x([b,-c,0,0,c,b,0,0,0,0,1,0,0,0,0,1],f.f);f.g=x(f.i,f.f)}else a.altKey||a.ctrlKey||a.metaKey?(f.f=x([1,0,0,0,0,1,0,0,0,0,1,-.02*f.h*b,0,0,0,1],f.f),f.g=x(f.i,f.f)):(f.h*=Math.pow(1.01,b),f.i=[1,0,0,0,0,1,0,0,0,0,1,-f.h,0,0,0,1],f.g=x(f.i,f.f));l()}a.preventDefault()})}B.prototype.clear=function(){this.K.clear();this.J.clear();this.o.clear()};B.prototype.S=function(){null===this.F&&(this.F=setTimeout(this.D.bind(this),0))};
B.prototype.D=function(){this.F=null;this.C.g&&(this.M="uniform vec3 uAmbient;\nuniform mat4 uModelViewMatrix;\n\nvarying vec4 vColor;\nvarying float vShininess;\n\nvec4 gColor;\nvec3 gPos;\nvec3 gEye;\nvec3 gNormal;\nvec3 gAccumDiffuse;\nvec3 gAccumSpecular;\n\nvoid commonLight(in vec4 lightPos,out vec3 lightDir,\nout float diffuseFactor,out float specularFactor){\nvec3 halfVector;\nfloat specularDot;\n\nlightDir=normalize(lightPos.xyz-lightPos.w*gPos);\nhalfVector=normalize(lightDir+gEye);\ndiffuseFactor=max(0.0,dot(gNormal,lightDir));\nspecularDot=max(0.0,dot(gNormal,halfVector));\n\n\nif(diffuseFactor==0.0)\nspecularFactor=0.0;\nelse\nspecularFactor=pow(specularDot,vShininess);\n}\n\nvec4 flipY(in vec4 v){\nreturn vec4(v.x, -v.y,v.z,v.w);\n}\n\nvoid pointLight(in vec4 lightPos,in vec3 diffuse,in vec3 specular){\nvec3 lightDir;\nfloat diffuseFactor;\nfloat specularFactor;\n\ncommonLight(lightPos,lightDir,diffuseFactor,specularFactor);\n\n\ngAccumDiffuse +=diffuse*diffuseFactor;\ngAccumSpecular+=specular*specularFactor;\n}\n\nvoid cameraPointLight(in vec4 lightPos,in vec3 diffuse,in vec3 specular){\npointLight(flipY(lightPos),diffuse,specular);\n}\n\nvoid worldPointLight(in vec4 lightPos,in vec3 diffuse,in vec3 specular){\npointLight(-uModelViewMatrix*lightPos,diffuse,specular);\n}\n\nvoid spotLight(\nin vec4 lightPos,in vec4 spotPos,in float spotCosCutoff,\nin float spotExponent,in vec3 diffuse,in vec3 specular)\n{\nvec3 lightDir;\nfloat diffuseFactor;\nfloat specularFactor;\nvec3 spotDir;\nfloat spotCosAngle;\nfloat spotAttenuation;\n\ncommonLight(lightPos,lightDir,diffuseFactor,specularFactor);\n\nspotDir=lightPos.w*spotPos.xyz-spotPos.w*lightPos.xyz;\nspotCosAngle=dot(-lightDir,normalize(spotDir));\nspotAttenuation=\nstep(spotCosCutoff,spotCosAngle) *pow(spotCosAngle,spotExponent);\n\n\ngAccumDiffuse +=spotAttenuation*diffuse*diffuseFactor;\ngAccumSpecular+=spotAttenuation*specular*specularFactor;\n}\n\nvoid cameraSpotLight(\nin vec4 lightPos,in vec4 spotPos,in float spotCosCutoff,\nin float spotExponent,in vec3 diffuse,in vec3 specular)\n{\nspotLight(\nflipY(lightPos),flipY(spotPos),\nspotCosCutoff,spotExponent,diffuse,specular);\n}\n\nvoid worldSpotLight(\nin vec4 lightPos,in vec4 spotPos,in float spotCosCutoff,\nin float spotExponent,in vec3 diffuse,in vec3 specular)\n{\nspotLight(\n-uModelViewMatrix*lightPos, -uModelViewMatrix*spotPos,\nspotCosCutoff,spotExponent,diffuse,specular);\n}\n"+ua(this.C)+
"\n\n\n\n\n\nvoid shade(in vec3 position,in vec3 normal){\n\ngAccumDiffuse=vec3(0.0);\ngAccumSpecular=vec3(0.0);\n\n\ngPos=position;\ngEye= -normalize(position);\ngNormal=sign(dot(gEye,normal))*normal;\n\n\nlightScene();\n\n\n\nvec3 color= (uAmbient+gAccumDiffuse) *gColor.xyz\n+gAccumSpecular;\n\ncolor=clamp(color,0.0,1.0);\ngl_FragColor=vec4(color.xyz,gColor.w);\n}\n",xa(this.K,this),xa(this.J,this),xa(this.o,this));if(1===this.g)ya(this);else{var a=this.f;a.bindFramebuffer(a.FRAMEBUFFER,this.O);
ya(this);a.bindFramebuffer(a.FRAMEBUFFER,null);a.viewport(0,0,this.width,this.height);a.disable(a.DEPTH_TEST);a.bindTexture(a.TEXTURE_2D,this.G);a.generateMipmap(a.TEXTURE_2D);a.bindBuffer(a.ARRAY_BUFFER,this.P);a.enableVertexAttribArray(this.H);a.vertexAttribPointer(this.H,4,a.FLOAT,!1,16,0);a.useProgram(this.I.f);this.I.h.uTexture([0]);a.drawArrays(a.TRIANGLE_STRIP,0,4);a.disableVertexAttribArray(this.H);a.bindTexture(a.TEXTURE_2D,null)}this.f.flush()};
function ya(a){var b=a.f;b.viewport(0,0,a.s,a.i);b.clearColor.apply(b,a.backgroundColor);b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT);a.K.v&&a.J.v&&a.o.v?(b.disable(b.BLEND),b.depthMask(!0),b.enable(b.DEPTH_TEST),za(a,!0)):(b.disable(b.DEPTH_TEST),b.enable(b.BLEND),b.depthMask(!1),za(a,!1),za(a,!1),b.depthMask(!0),b.enable(b.DEPTH_TEST),za(a,!1))}function za(a,b){b||a.K.D(a,1);a.o.D(a);a.J.D(a);a.K.D(a,-1)}
B.prototype.h=function(a){a.uProjectionMatrix(this.A.s);var b=this.A.g;a.uModelViewMatrix([b[0],b[4],b[8],b[12],b[1],b[5],b[9],b[13],b[2],b[6],b[10],b[14],b[3],b[7],b[11],b[15]]);b=this.C;a.uAmbient(b.ca);for(var c=0;c<b.f.length;++c)b.f[c]&&Aa(b.f[c],a,c)};function ta(){this.ca=[0,0,0];this.f=[new Ba([0,0,0,1],[1,1,1],[1,1,1])];this.g=!1}function Ca(a,b,c){a.g=!c!==!a.f[b]||!!c&&a.f[b].f!==c.f;a.f[b]=c}function ua(a){for(var b="",c="",d=0;d<a.f.length;++d)a.f[d]&&(b+=Da(a.f[d],d),c+=Ea(a.f[d],d));return b+"void lightScene() {\n"+c+"}"}function H(a,b){this.f=a;this.g=b}H.prototype.h={uDiffuse:"vec3",uSpecular:"vec3",uLightPos:"vec4",uSpotPos:"vec4",uSpotCosCutoff:"float",uSpotExponent:"float"};
function Ea(a,b){return"  "+a.f+"("+a.g.map(function(a){return a+b}).join(", ")+");\n"}function Da(a,b){return a.g.map(function(c){return"uniform "+a.h[c]+" "+c+b+";\n"}).join("")}function Aa(a,b,c){a.g.forEach(function(d){return b[d+c](a[d])})}function Ba(a,b,c){this.uLightPos=a;this.uDiffuse=b;this.uSpecular=c}Ba.prototype=new H("cameraPointLight",["uLightPos","uDiffuse","uSpecular"]);function Fa(a,b,c){this.uLightPos=a;this.uDiffuse=b;this.uSpecular=c}
Fa.prototype=new H("worldPointLight",["uLightPos","uDiffuse","uSpecular"]);var Ga={camera:Ba,world:Fa};function Ha(a,b,c,d,e,g){this.uLightPos=a;this.uSpotPos=b;this.uSpotCosCutoff=[c];this.uSpotExponent=[d];this.uDiffuse=e;this.uSpecular=g}Ha.prototype=new H("cameraSpotLight","uLightPos uSpotPos uSpotCosCutoff uSpotExponent uDiffuse uSpecular".split(" "));function Ia(a,b,c,d,e,g){this.uLightPos=a;this.uSpotPos=b;this.uSpotCosCutoff=[c];this.uSpotExponent=[d];this.uDiffuse=e;this.uSpecular=g}
Ia.prototype=new H("worldSpotLight","uLightPos uSpotPos uSpotCosCutoff uSpotExponent uDiffuse uSpecular".split(" "));var Ma={camera:Ha,world:Ia};function K(a,b){var c=a.length,d=b.length,e=Math.max.apply(null,b)+1;this.ia=a;this.R=c;this.aa=e;this.P=b;this.S=d;this.s=4*e*c;this.ba=16*c;this.i=a=e*this.ba;this.M=a+d*this.H;this.I=Math.floor(65536/a)}K.prototype.H=2;
function Na(a,b,c){a.ja=b;a.f=0;a.v=!0;a.g=16;a.F=new ArrayBuffer(16*a.M);a.G=new Float32Array(a.F,0,16*a.s);b=new Uint16Array(a.F,16*a.i);a.h=b;var d,e,g=0,f,l=a.P;for(d=0;16>d;++d)for(f=d*a.aa,e=0;e<l.length;++e)b[g++]=l[e]+f;a.ka=c.f.createBuffer();a.la=c.f.createBuffer();a.O=-1;a.B=null;xa(a,c)}
function xa(a,b){var c=b.f;a.B&&da(a.B,c);var d=["precision mediump float;\nvarying float vShininess;",a.$].join("\n"),e=["precision mediump float;",b.M,a.Y].join("\n");b.B&&(e="#extension GL_EXT_frag_depth : enable\n"+e);a.B=new aa(c,d,e);var g=a.B.f;a.N=a.ia.map(function(a){return c.getAttribLocation(g,a)})}
function Oa(a,b){if(b.length!==a.s)throw new r("Wrong number of attributes given");if(a.f==a.g){var c=2*a.g,d,e,g,f,l,m,k,n=a.P;c>a.I&&(a.g<a.I?c=a.I:(a.H=4,a.M=a.i+a.S*a.H,a.I=Math.floor(Math.pow(2,32)/a.i)));d=new ArrayBuffer(c*a.M);e=new Float32Array(d,0,c*a.s);2===a.H?g=new Uint16Array(d,c*a.i):g=new Uint32Array(d,c*a.i);e.set(a.G);g.set(a.h);m=a.h.length;for(f=a.g;f<c;++f)for(k=f*a.aa,l=0;l<n.length;++l)g[m++]=n[l]+k;a.g=c;a.F=d;a.G=e;a.h=g}a.G.set(b,a.f++*a.s)}
function Pa(a,b,c){if(a.f){var d=a.B,e=d.h;b.useProgram(d.f);c(e);b.bindBuffer(b.ARRAY_BUFFER,a.ka);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a.la);a.O!==a.g?(b.bufferData(b.ARRAY_BUFFER,a.G,b.STATIC_DRAW),b.bufferData(b.ELEMENT_ARRAY_BUFFER,a.h,b.STATIC_DRAW),a.O=a.g):b.bufferSubData(b.ARRAY_BUFFER,0,new Float32Array(a.F,0,a.f*a.s));for(c=0;c<a.R;++c)d=a.N[c],b.enableVertexAttribArray(d),b.vertexAttribPointer(d,4,b.FLOAT,!1,a.ba,16*c);c=b.UNSIGNED_SHORT;a.h instanceof Uint32Array&&(c=b.UNSIGNED_INT,b.getExtension("OES_element_index_uint"));
b.drawElements(a.ja,a.S*a.f,c,0);for(c=0;c<a.R;++c)b.disableVertexAttribArray(a.N[c])}}K.prototype.clear=function(){this.f=0;this.v=!0};function C(a){Na(this,a.f.TRIANGLES,a)}C.prototype=new K(["aCenter","aColor","aRelativeShininessRadius"],[0,1,2,2,1,3]);C.prototype.$="uniform mat4 uProjectionMatrix;\n\nuniform mat4 uModelViewMatrix;\n\nattribute vec4 aCenter;\n\nattribute vec4 aColor;\n\nattribute vec4 aRelativeShininessRadius;\n\nvarying vec3 vViewSpacePos;\n\nvarying vec3 vViewSpaceCenter;\n\nvarying vec4 vColor;\n\nvarying float vRadius;\n\n\n\n\nvoid main(){\n\nvec4 viewPosHom=uModelViewMatrix*aCenter;\nvViewSpaceCenter=viewPosHom.xyz/viewPosHom.w;\nvec3 dir=normalize(-vViewSpaceCenter);\nvec3 right=normalize(cross(dir,vec3(0,1,0)));\nvec3 up=normalize(cross(right,dir));\n\n\nvColor=aColor;\nvShininess=aRelativeShininessRadius.z;\nvRadius=aRelativeShininessRadius.w;\n\n\nvViewSpacePos=vViewSpaceCenter+\nvRadius*(right*aRelativeShininessRadius.x+\nup*aRelativeShininessRadius.y+dir);\n\n\ngl_Position=uProjectionMatrix*vec4(vViewSpacePos,1);\n}\n";
C.prototype.Y="uniform mat4 uProjectionMatrix;\n\nvec3 sphere(in vec3 ray,in vec3 center,in float radius,in float face){\n\nvec3 dir=normalize(ray);\n\n\n\n\nfloat b=dot(center,dir);\nfloat c=dot(center,center) -radius*radius;\nfloat d=b*b-c;\nif(d<0.0)discard;\nfloat lambda=b+face*sqrt(d);\nif(lambda<0.0)discard;\n\n\nreturn lambda*dir;\n}\n\nvoid finish(in vec3 pos,in vec3 normal){\nshade(pos,normal);\n#ifdef GL_EXT_frag_depth\nvec4 projPoint=uProjectionMatrix*vec4(pos,1);\ngl_FragDepthEXT= (projPoint.z/projPoint.w+1.0) /2.0;\n#endif\n}\n\n\nuniform float sphereMode;\n\n\nvarying vec3 vViewSpacePos;\n\nvarying vec3 vViewSpaceCenter;\n\nvarying float vRadius;\n\n\n\n\nvoid main(){\ngColor=vColor;\nvec3 pointOnSphere=\nsphere(vViewSpacePos,vViewSpaceCenter,vRadius,sphereMode);\nvec3 normal=normalize(pointOnSphere-vViewSpaceCenter);\nfinish(pointOnSphere,normal);\n}\n";
C.prototype.add=function(a,b,c){var d=a[0],e=a[1],g=a[2];a=a[3];var f=c.color,l=c.l,m=f[0],k=f[1],f=f[2];c=c.alpha;1>c&&(this.v=!1);Oa(this,[d,e,g,a,m,k,f,c,1,1,l,b,d,e,g,a,m,k,f,c,-1,1,l,b,d,e,g,a,m,k,f,c,1,-1,l,b,d,e,g,a,m,k,f,c,-1,-1,l,b])};C.prototype.D=function(a,b){Pa(this,a.f,function(c){a.h(c);c.sphereMode([b])})};function D(a){Na(this,a.f.TRIANGLE_STRIP,a)}D.prototype=new K(["aPoint1","aPoint2","aColor","aRelativeRadius","aShininess"],[0,0,2,4,6,7,2,3,1,7,5,4,1,0,2,2]);D.prototype.$="uniform mat4 uProjectionMatrix;\n\nuniform mat4 uModelViewMatrix;\n\nattribute vec4 aPoint1;\n\nattribute vec4 aPoint2;\n\nattribute vec4 aColor;\n\nattribute vec4 aRelativeRadius;\n\nattribute vec4 aShininess;\n\nvarying vec3 vPoint1;\n\nvarying vec3 vPoint2;\n\nvarying vec3 vPos;\n\nvarying vec4 vColor;\n\nvarying float vRadius;\n\n\n\n\nvoid main(){\n\nvec4 hom;\nhom=uModelViewMatrix*aPoint1;\nvPoint1=hom.xyz/hom.w;\nhom=uModelViewMatrix*aPoint2;\nvPoint2=hom.xyz/hom.w;\nvec3 dir=normalize(vPoint2-vPoint1);\n\n\nvec3 d2,d3;\nif(abs(dir.x) <abs(dir.y))\nd2=vec3(1,0,0);\nelse\nd2=vec3(0,1,0);\nd2=normalize(cross(dir,d2));\nd3=normalize(cross(dir,d2));\n\nvPos=aRelativeRadius.w*(mat3(dir,d2,d3)*aRelativeRadius.xyz)\n+0.5*((vPoint2+vPoint1) +aRelativeRadius.x*(vPoint2-vPoint1));\n\n\nvColor=aColor;\nvShininess=aShininess.x;\nvRadius=aRelativeRadius.w;\n\n\ngl_Position=uProjectionMatrix*vec4(vPos,1);\n}\n";
D.prototype.Y="uniform mat4 uProjectionMatrix;\n\nvec3 sphere(in vec3 ray,in vec3 center,in float radius,in float face){\n\nvec3 dir=normalize(ray);\n\n\n\n\nfloat b=dot(center,dir);\nfloat c=dot(center,center) -radius*radius;\nfloat d=b*b-c;\nif(d<0.0)discard;\nfloat lambda=b+face*sqrt(d);\nif(lambda<0.0)discard;\n\n\nreturn lambda*dir;\n}\n\nvoid finish(in vec3 pos,in vec3 normal){\nshade(pos,normal);\n#ifdef GL_EXT_frag_depth\nvec4 projPoint=uProjectionMatrix*vec4(pos,1);\ngl_FragDepthEXT= (projPoint.z/projPoint.w+1.0) /2.0;\n#endif\n}\n\nvarying vec3 vPoint1;\n\nvarying vec3 vPoint2;\n\nvarying vec3 vPos;\n\nvarying float vRadius;\n\nvec3 endcaps(in float mu,inout vec3 pos){\nvec3 center;\nif(mu<0.0){\ncenter=vPoint1;\n}else if(mu>1.0){\ncenter=vPoint2;\n}else{\nreturn(1.0-mu)*vPoint1+mu*vPoint2;\n}\npos=sphere(vPos,center,vRadius, -1.0);\nreturn center;\n}\n\n\n\n\nvoid main(){\ngColor=vColor;\n\n\n\nvec3 ba=vPoint2-vPoint1;\nvec3 u=ba/dot(ba,ba);\nvec3 v=vPos-dot(vPos,ba)*u;\nvec3 w=dot(vPoint1,ba)*u-vPoint1;\nfloat a=dot(v,v);\nfloat b=2.0*dot(v,w);\nfloat c=dot(w,w) -vRadius*vRadius;\nfloat d=b*b-4.0*a*c;\nif(d<0.0)\ndiscard;\nfloat lambda= (b+sqrt(d))/(-2.0*a);\nvec3 pointOnSurface=lambda*vPos;\nfloat mu=dot(pointOnSurface-vPoint1,u);\nvec3 center=endcaps(mu,pointOnSurface);\nvec3 normal=normalize(pointOnSurface-center);\nfinish(pointOnSurface,normal);\n}\n";
D.prototype.add=function(a,b,c){var d=a[0],e=a[1],g=a[2];a=a[3];var f=b[0],l=b[1],m=b[2];b=b[3];var k=c.color,n=c.l,h=c.size,p=k[0],z=k[1],k=k[2];c=c.alpha;1>c&&(this.v=!1);Oa(this,[d,e,g,a,f,l,m,b,p,z,k,c,1,1,1,h,n,0,0,0,d,e,g,a,f,l,m,b,p,z,k,c,1,1,-1,h,n,0,0,0,d,e,g,a,f,l,m,b,p,z,k,c,1,-1,1,h,n,0,0,0,d,e,g,a,f,l,m,b,p,z,k,c,1,-1,-1,h,n,0,0,0,d,e,g,a,f,l,m,b,p,z,k,c,-1,1,1,h,n,0,0,0,d,e,g,a,f,l,m,b,p,z,k,c,-1,1,-1,h,n,0,0,0,d,e,g,a,f,l,m,b,p,z,k,c,-1,-1,1,h,n,0,0,0,d,e,g,a,f,l,m,b,p,z,k,c,-1,-1,
-1,h,n,0,0,0])};D.prototype.D=function(a){if(this.f){var b=a.f;b.enable(b.CULL_FACE);b.cullFace(b.BACK);Pa(this,b,a.h.bind(a));b.disable(b.CULL_FACE)}};function va(a){Na(this,a.f.TRIANGLES,a)}va.prototype=new K(["aPos","aNormalAndShininess","aColor"],[0,1,2]);q=va.prototype;q.$="uniform mat4 uProjectionMatrix;\nuniform mat4 uModelViewMatrix;\n\nattribute vec4 aPos;\nattribute vec4 aNormalAndShininess;\nattribute vec4 aColor;\n\nvarying vec4 vPos;\nvarying vec4 vNormal;\nvarying vec4 vColor;\n\nvoid main(){\nvPos=uModelViewMatrix*aPos;\ngl_Position=uProjectionMatrix*vPos;\nvNormal=uModelViewMatrix*vec4(aNormalAndShininess.xyz,0.0);\nvShininess=aNormalAndShininess.w;\nvColor=aColor;\n}\n";
q.Y="uniform mat4 uProjectionMatrix;\n\nvec3 sphere(in vec3 ray,in vec3 center,in float radius,in float face){\n\nvec3 dir=normalize(ray);\n\n\n\n\nfloat b=dot(center,dir);\nfloat c=dot(center,center) -radius*radius;\nfloat d=b*b-c;\nif(d<0.0)discard;\nfloat lambda=b+face*sqrt(d);\nif(lambda<0.0)discard;\n\n\nreturn lambda*dir;\n}\n\nvoid finish(in vec3 pos,in vec3 normal){\nshade(pos,normal);\n#ifdef GL_EXT_frag_depth\nvec4 projPoint=uProjectionMatrix*vec4(pos,1);\ngl_FragDepthEXT= (projPoint.z/projPoint.w+1.0) /2.0;\n#endif\n}\n\nvarying vec4 vPos;\nvarying vec4 vNormal;\n\nuniform bool uTextured;\nuniform sampler2D uTexture;\n\nvoid main(){\nif(uTextured)\ngColor=texture2DProj(uTexture,vColor.xyz);\nelse\ngColor=vColor;\nfinish(vPos.xyz/vPos.w,normalize(vNormal.xyz));\n}\n";
function L(a,b,c,d,e,g,f,l){var m=l.color,k=l.l,n=m[0],h=m[1],m=m[2];l=l.alpha;1>l&&(a.v=!1);Oa(a,[b[0],b[1],b[2],b[3],e[0],e[1],e[2],k,n,h,m,l,c[0],c[1],c[2],c[3],g[0],g[1],g[2],k,n,h,m,l,d[0],d[1],d[2],d[3],f[0],f[1],f[2],k,n,h,m,l])}function Qa(a,b,c,d,e,g,f,l,m,k,n){var h=n.l;n=n.alpha;1>n&&(a.v=!1);Oa(a,[b[0],b[1],b[2],b[3],e[0],e[1],e[2],h,l[0],l[1],l[2],n,c[0],c[1],c[2],c[3],g[0],g[1],g[2],h,m[0],m[1],m[2],n,d[0],d[1],d[2],d[3],f[0],f[1],f[2],h,k[0],k[1],k[2],n])}
function Ra(a,b,c){if(3==b.length){var d=b[0],e=b[1];b=b[2];var g=ia(d,e,b);L(a,d,e,b,g,g,g,c)}else{for(var d=b.length,f=Array(d+2),g=[0,0,0],e=0;e<d;++e)f[e]=t(b[e]);f[d]=f[0];f[d+1]=f[1];for(e=1;e<=d;++e)g=ga(g,w(u(f[e],f[e-1]),u(f[e],f[e+1])));if(4==d)L(a,b[0],b[1],b[3],g,g,g,c),L(a,b[3],b[1],b[2],g,g,g,c);else{for(var f=[0,0,0,0],l=b[d-1],e=0;e<d;++e)f=ha(f,b[e]);for(e=0;e<d;++e)L(a,l,b[e],f,g,g,g,c),l=b[e]}}}
function Sa(a,b,c,d){if(3==b.length)L(a,b[0],b[1],b[2],c[0],c[1],c[2],d);else if(4==b.length)L(a,b[0],b[1],b[3],c[0],c[1],c[3],d),L(a,b[3],b[1],b[2],c[3],c[1],c[2],d);else{var e=b.length,g,f=[0,0,0,0],l=[0,0,0];for(g=0;g<e;++g)f=ha(f,b[g]),l=ga(l,c[g]);var m=b[e-1],k=c[e-1];for(g=0;g<e;++g)L(a,m,b[g],f,k,c[g],l,d),m=b[g],k=c[g]}}q.j=null;q.Z=null;q.L=null;q.fa=null;q.ga=null;
q.D=function(a){var b=a.f;if(this.j){if(this.j.ready){this.j.ma&&this.j.ma();this.Z||(this.Z=b.createTexture());var c=this.j.width,d=this.j.height,c=Ta(c),d=Ta(d);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,this.Z);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.REPEAT);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.LINEAR_MIPMAP_LINEAR);b.hint(b.GENERATE_MIPMAP_HINT,
b.NICEST);if(this.j.live||this.fa!==this.j||this.ga!==this.j.generation){this.fa=this.j;this.ga=this.j.generation;var e=this.j.img;if(c!==this.j.width||d!==this.j.height)this.L||(this.L=document.createElement("canvas"),this.L.width=c,this.L.height=d),e=this.L.getContext("2d"),e.clearRect(0,0,c,d),e.drawImage(this.j.img,0,0,c,d),e=this.L;b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,e);b.generateMipmap(b.TEXTURE_2D)}Pa(this,b,function(b){a.h(b);b.uTextured([!0]);b.uTexture([0])});b.bindTexture(b.TEXTURE_2D,
null)}}else Pa(this,b,function(b){a.h(b);b.uTextured([!1])})};function Ta(a){if(!(a&a-1))return a;for(var b=1;b<a;)b*=2;return b};function M(a){var b;b=b?b:null;return"list"!==a.ctype?(console.log("argument is not a list"),b):a.value}function N(a,b,c){b=b?b:[0,0,0,0];c=void 0===c?3:c;a=M(a);if(!a)return b;b=a.map(O);b.length>c+1&&(console.log("Coordinate vector too long."),b=b.slice(0,c+1));for(;b.length<c;)b.push(0);b.length===c&&b.push(1);return b}function S(a,b){b=b?b:[0,0,0];a=M(a);if(!a)return b;b=a.map(O);3<b.length&&(console.log("Coordinate vector too long."),b=b.slice(0,3));for(;3>b.length;)b.push(0);return b}
function Ua(a,b){b=b?b:[0,0,0,0];a=S(a,b);a!==b&&(a[3]=0);return a}function T(a,b){b=b?b:[.5,.5,.5];if("number"===a.ctype){var c=U(0,1,a);if(!isNaN(c))return[c,c,c]}a=M(a);return a?3!=a.length?(console.log("Not an RGB color vector"),b):a.map(function(a){return U(0,1,a)}):b}function O(a,b){b=void 0===b?Number.NaN:b;if("number"!==a.ctype)return console.log("argument is not a number"),b;a=a.value;b=a.real;0!==a.imag&&console.log("complex number is not real");return b}
function V(a,b){b=void 0===b?Number.NaN:b;if("number"!==a.ctype)return console.log("argument is not a number"),b;b=a.value;a=b.real;b=b.imag;0!==b&&console.log("complex number is not real");b=Math.round(a);b!==a&&console.log("number is not an integer");return b}function U(a,b,c,d){d=void 0===d?Number.NaN:d;c=O(c,d);return c<a?a:c>b?b:c}function W(a,b){b=void 0===b?null:b;if("string"===a.ctype)return a.value;console.log("argument is not a string");return b}
function Va(a,b){var c=["camera","world"];b=void 0===b?null:b;a=W(a,b);if(a!==b&&-1!==c.indexOf(a))return a;console.log("argument is not one of "+c.join(", "));return b};CindyJS.registerPlugin(1,"Cindy3D",function(a){function b(a,b){var c,d;for(c in a)(d=b[c])?d(m(a[c])):console.log("Modifier "+c+" not supported")}function c(a,c,d){d=d?d:null;var e=a.color,h=a.alpha,f=a.l,g=a.size;a={color:function(a){return e=T(a)},alpha:function(a){return h=U(0,1,a)},shininess:function(a){return f=U(0,128,a)},size:function(a){return g=.05*O(a)}};var l;if(d)for(l in d)a[l]=d[l];b(c,a);return{color:e,alpha:h,l:f,size:g}}function d(a){h.m.alpha=U(0,1,m(a[0]),1);return l}function e(a,
b,c,d,e){for(var h=0,f=1;f<a;++f){for(var l=1;l<b;++l)e(h,h+1,h+b+1,h+b),++h;c&&e(h,h+1-b,h+1,h+b);++h}if(d){for(a=1;a<b;++a)e(h,h+1,a,a-1),++h;c&&e(h,h+1-b,0,b-1)}}function g(a,b,c,d,f,l,g,m,k){var n;n=g?"perface"===m?function(a){return g[a]}:function(a,b){return g[b]}:function(){return k.color};e(a,b,c,d,function(a,b,c,p){var d;d=h.o;var e=[f[a],f[b],f[c],f[p]],g=[l[a],l[b],l[c],l[p]];a=[n(a,a),n(a,b),n(a,c),n(a,p)];3==e.length?d=Qa(d,e[0],e[1],e[2],g[0],g[1],g[2],a[0],a[1],a[2],k):(4==e.length?
(Qa(d,e[0],e[1],e[3],g[0],g[1],g[3],a[0],a[1],a[3],k),Qa(d,e[3],e[1],e[2],g[3],g[1],g[2],a[3],a[1],a[2],k)):console.error("addPolygonWithNormalsAndColors not supported for more than 4 corners"),d=void 0);return d})}function f(b,d){function f(a,b){a=w(u(a,qa),u(b,qa));F[0]+=a[0];F[1]+=a[1];F[2]+=a[2];++ra}var k=V(m(b[0])),v=V(m(b[1])),E=M(m(b[2])).map(function(a){return N(a)}),n="perface",X="pervertex",A="open",P=null,na=null,oa=null,pa=c(h.m,d,{normaltype:function(a){return n=W(a,n).toLowerCase()},
colortype:function(a){return X=W(a,X).toLowerCase()},topology:function(a){return A=W(a,A).toLowerCase()},colors:function(a){return P=M(a).map(function(a){return T(a)})},uv:function(a){return na=M(a).map(function(a){return N(a,[0,0,0],2)})},texture:function(b){return oa=a.getImage(b,!0)}});if(E.length!==k*v)return l;oa&&na&&(h.o.j=oa,h.o.v=!1,P=na,X="pervertex");if(null!==P&&P.length!==k*v)return l;d="closerows"===A||"closeboth"===A;var I="closecolumns"===A||"closeboth"===A,qa=null,F=null,ra=0;if(4===
b.length){b=M(m(b[3])).map(function(a){return S(a)});if(b.length!==k*v)return l;g(k,v,d,I,E,b,P,X,pa)}else if("pervertex"===n){b=Array(k*v);for(var Y=k*v,Z=E.map(t),Q=0,sa=0;Q<k;++Q)for(var R=0;R<v;++R){var J=sa+Y,qa=Z[sa],Ja=Z[(J-1)%Y],Ka=Z[(J+1)%Y],La=Z[(J-v)%Y],J=Z[(J+v)%Y],F=[0,0,0],ra=0;(I||0<Q)&&(d||0<R)&&f(Ja,La);(I||Q+1<k)&&(d||0<R)&&f(J,Ja);(I||Q+1<k)&&(d||R+1<v)&&f(Ka,J);(I||0<Q)&&(d||R+1<v)&&f(La,Ka);b[sa++]=fa(4/ra,F)}g(k,v,d,I,E,b,P,X,pa)}else e(k,v,d,I,function(a,b,c,d){return Ra(h.o,
[E[a],E[b],E[c],E[d]],pa)});return l}var l=a.nada,m=a.evaluate,k=a.defineFunction,n={},h;k("begin3d",0,function(c,d){var e="Cindy3D",f={},g={};b(d,{name:function(a){return e=W(a,e)},antialias:function(a){"boolean"===a.ctype?a=a.value:(console.log("argument is not boolean"),a=!1);return f.antialias=a},supersample:function(a){return g.ha=O(a,1)}});(h=n[e])||(n[e]=h=new B(e,f,g,a.addAutoCleaningEventListener));h.clear();return l});k("end3d",0,function(){h.D();h=null;return l});k("gsave3d",0,function(){h.da.push({U:y(h.w),
T:y(h.u),V:y(h.m)});return l});k("grestore3d",0,function(){var a=h.da;0<a.length?(a=a.pop(),h.w=a.U,h.u=a.T,h.m=a.V):(h.w=y(G.U),h.u=y(G.T),h.m=y(G.V));return l});k("color3d",1,function(a){if(a=T(m(a[0]),null))h.w.color=a,h.u.color=a,h.m.color=a;return l});k("pointcolor3d",1,function(a){if(a=T(m(a[0]),null))h.w.color=a;return l});k("linecolor3d",1,function(a){if(a=T(m(a[0]),null))h.u.color=a;return l});k("surfacecolor3d",1,function(a){if(a=T(m(a[0]),null))h.m.color=a;return l});k("alpha3d",1,d);k("surfacealpha3d",
1,d);k("shininess3d",1,function(a){a=U(0,128,m(a[0]));isNaN(a)||(h.w.l=a,h.u.l=a,h.m.l=a);return l});k("pointshininess3d",1,function(a){a=U(0,128,m(a[0]));isNaN(a)||(h.w.l=a);return l});k("lineshininess3d",1,function(a){a=U(0,128,m(a[0]));isNaN(a)||(h.u.l=a);return l});k("surfaceshininess3d",1,function(a){a=U(0,128,m(a[0]));isNaN(a)||(h.m.l=a);return l});k("size3d",1,function(a){a=.05*O(m(a[0]),-1);0<=a&&(h.w.size=a,h.u.size=a);return l});k("pointsize3d",1,function(a){a=.05*O(m(a[0]),-1);0<=a&&(h.w.size=
a);return l});k("linesize3d",1,function(a){a=.05*O(m(a[0]),-1);0<=a&&(h.u.size=a);return l});k("draw3d",1,function(a,b){a=N(m(a[0]));b=c(h.w,b);h.K.add(a,b.size,b);return l});k("draw3d",2,function(a,b){var d=N(m(a[0]));a=N(m(a[1]));b=c(h.u,b);h.J.add(d,a,b);return l});k("connect3d",1,function(a,b){a=M(m(a[0]));b=c(h.u,b);if(2>a.length)return l;for(var d=N(a[0]),e=1;e<a.length;++e){var f=N(a[e]);h.J.add(d,f,b);d=f}return l});k("drawpoly3d",1,function(a,b){a=M(m(a[0]));b=c(h.u,b);if(2>a.length)return l;
for(var d=N(a[a.length-1]),e=0;e<a.length;++e){var f=N(a[e]);h.J.add(d,f,b);d=f}return l});k("fillpoly3d",1,function(a,b){a=M(m(a[0]));b=c(h.m,b);if(2>a.length)return l;a=a.map(function(a){return N(a)});Ra(h.o,a,b);return l});k("fillpoly3d",2,function(a,b){var d=M(m(a[0]));a=M(m(a[1]));b=c(h.m,b);if(2>d.length||d.length!=a.length)return l;d=d.map(function(a){return N(a)});a=a.map(function(a){return S(a)});Sa(h.o,d,a,b);return l});k("fillcircle3d",3,function(){return l});k("drawsphere3d",2,function(a,
b){var d=N(m(a[0]));a=O(m(a[1]));b=c(h.m,b);h.K.add(d,a,b);return l});k("mesh3d",3,function(a,b){return f(a,b)});k("mesh3d",4,function(a,b){return f(a,b)});k("triangle3d",1,function(b,d){b=M(m(b[0])).map(function(a){return N(a)});var e=null,f=null,g=null,k=null;d=c(h.m,d,{colors:function(a){return k=M(a).map(function(a){return T(a)})},uv:function(a){return e=M(a).map(function(a){return N(a,[0,0,0],2)})},texture:function(a){return f=W(a)},normals:function(a){return g=M(a).map(function(a){return S(a)})}});
if(!b||3!==b.length)return l;if(null!==f&&e){var n=a.getImage(f);if(!n)return console.log("No such texture image: "+f),l;h.o.j=n;h.o.v=!1;k=e}if(null!==k&&3!==k.length||g&&3!==g.length)return l;k||(k=[d.color,d.color,d.color]);g||(n=ia(b[0],b[1],b[2]),g=[n,n,n]);Qa(h.o,b[0],b[1],b[2],g[0],g[1],g[2],k[0],k[1],k[2],d);return l});k("background3d",1,function(a){if(a=T(m(a[0]),null))a.push(1),h.backgroundColor=a;return l});k("lookat3d",3,function(a){var b=N(m(a[0]),null),c=N(m(a[1]),null);a=S(m(a[2]),
null);b&&c&&a&&la(h.A,t(b),t(c),a);return l});k("fieldofview3d",1,function(a){a=U(.01,3.13,m(a[0]),0);0<a&&(h.A.ea=a,ka(h.A));return l});k("depthrange3d",2,function(a){var b=O(m(a[0]),-1);a=O(m(a[1]),-1);0<=b&&a>b&&(h.A.X=b,h.A.W=a,ka(h.A));return l});k("renderhints3d",0,function(){return l});k("pointlight3d",1,function(a,c){a=V(m(a[0]),0);var d=[0,0,0,1],e=[1,1,1],f=[1,1,1],g="camera";b(c,{position:function(a){return d=N(a,d)},diffuse:function(a){return e=T(a,e)},specular:function(a){return f=T(a,
f)},frame:function(a){return g=Va(a,g)}});Ca(h.C,a,new Ga[g](d,e,f));return l});k("directionallight3d",1,function(a,c){a=V(m(a[0]),0);var d=[0,-1,0,0],e=[1,1,1],f=[1,1,1],g="camera";b(c,{direction:function(a){return d=Ua(a,d)},diffuse:function(a){return e=T(a,e)},specular:function(a){return f=T(a,f)},frame:function(a){return g=Va(a,g)}});Ca(h.C,a,new Ga[g](d,e,f));return l});k("spotlight3d",1,function(a,c){a=V(m(a[0]),0);var d=[0,0,0,1],e=[0,-1,0,0],f=Math.PI/4,g=0,k=[1,1,1],n=[1,1,1],A="camera";
b(c,{position:function(a){return d=N(a,d)},direction:function(a){return e=Ua(a,e)},cutoffangle:function(a){return f=U(0,Math.PI,a,f)},exponent:function(a){return g=O(a,g)},diffuse:function(a){return k=T(a,k)},specular:function(a){return n=T(a,n)},frame:function(a){return A=Va(a,A)}});Ca(h.C,a,new Ma[A](d,e,Math.cos(f),g,k,n));return l});k("disablelight3d",1,function(a){a=V(m(a[0]),0);Ca(h.C,a,null);return l});k("ambientlight3d",1,function(a){if(a=T(m(a[0])))h.C.ca=a;return l})});
}).call(this);//# sourceMappingURL=Cindy3D.js.map

